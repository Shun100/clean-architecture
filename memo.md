# ソフトウェアアーキテクチャ

- レイヤードアーキテクチャ

- ヘキサゴナルアーキテクチャ
  - メリット
    - ビジネスロジックが外部の詳細と切り離されているため保守性が高い
    - ポートとアダプターにより外部システムの切り替えが容易
  - デメリット
    - ポートアダプターの概念を理解する必要がある
  - 使いどころ
    - 外部システムや技術的な依存関係が多いアプリケーション

- オニオンアーキテクチャ
  - 特徴
    - ドメインモデルを中心に置き、外側にUIやインフラ層を配置する円構造
    - 全ての依存が外側から内側に向く
  - メリット
    - ビジネスロジックが外側の技術的詳細の影響を受けない
    - ドメイン駆動設計と相性が良い
  - デメリット
    - どの層に何を実装するのかが慣れるまで分かりづらい
    - 小規模プロジェクトでは過剰な設計となる可能性がある

- クリーンアーキテクチャ
  - 特徴
    - ビジネスロジックを中心に置き、外側にUIやインフラ層を配置する円構造
    - 全ての依存が外側から内側に向く
  - メリット
    - ビジネスロジックが外側の技術的詳細の影響を受けない
    - 各層のテストが容易
    - 各層の役割が明確化されてコード整理が容易になる
  - デメリット
    - ディレクトリやファイル数が増えて初期の開発コストが高い
    - 小規模プロジェクトでは過剰な設計となる可能性が高い
  - 使いどころ
    - 長期間にわたって保守や拡張が求められる大規模で複雑なアプリケーション開発

## 注意点

- 全てをアーキテクチャパターンに当てはめようとしないこと


## 題材とするアプリケーション

- 図書館アプリ
  - 書籍管理機能
    - 書籍の登録
      - ID、タイトル、利用可能フラグを持つ書籍が登録できる
    - IDで検索可能
  - ユーザ管理機能
    - ID、メールアドレスを持つユーザを作成できる
  - 書籍貸出管理機能
    - 書籍の貸出
      - 貸出期間は2w
      - 一度に借りられるのは5冊まで
    - 書籍の返却

## 環境構築

``` bash
npm init -y

# ExpressとPrisma Clientのインストール
npm i express @prisma/client

# TypesScriptのインストール
npm i -D typescript @types/node @types/express ts-node-dev prisma

# TypeScriptプロジェクトの初期化
npx tsc --init

```

## セットアップ手順

``` bash
cd app

# package.json（依存関係一覧）の作成
npm init -y

# prisma/schema.prismaの作成（初回のみ）
docker-compose run --rm app npx prisma init

docker compose run --rm app npx prisma migrate dev --name init

docker compose up -d
```